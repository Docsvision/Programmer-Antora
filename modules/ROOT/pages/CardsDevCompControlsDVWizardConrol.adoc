= Элемент управления WizardConrol

Элемент управления *WizardControl* позволяет облегчить процесс создания стандартных Мастеров (последовательность форм с возможностью навигации вперед/назад). Внешний вид элемента управления:

image::dev_card_39.png[[.fig--title-label]##Рис. 1. ##WizardControl]

*WizardControl* имеет ряд свойств, определяющих его внешний вид и поведение:

* int**ButtonHeight** – высота стандартныхкнопок (Back, Next, Cancel, Finish)
* int *ButtonWidth -* ширинастандартныхкнопок (Back, Next, Cancel, Finish)
* int**HorizontalSpacing –** расстояние между кнопками по горизонтали
* int**VerticalSpacing –** расстояние между кнопками по вертикали
* string**BackButtonText –** текст кнопки “Back”
* string**CancelButtonText –** текст кнопки “Cancel”
* string**FinishButtonText –** текст кнопки “Finish”
* string**HelpButtonText –** текст кнопки “Help”
* System.Drawing.Size**DefaultSize** – начальный размер элемента управления
* System.Windows.Forms.FlatStyle**FlatStyle –** стиль отрисовки элемента управления
* bool *HelpButtonVisible –* признак, отображать ли кнопку помощи (Help)

Собственно, набор шагов Мастера задается при помощи коллекции WizardPages – которую можно редактировать при помощи специального визуального редактора:

image::dev_card_40.png[[.fig--title-label]##Рис. 2. ##WizardControl]

Редактор позволяет добавить произвольное количество страниц (шагов Мастера), а также менять порядок их следования. Каждая страница имеет единственное значимое свойство – *Text*, которое позволяет определить заголовок страницы.

После определения всех страниц, они появляются в Мастере, и можно добавлять интерактивные элементы управления непосредственно на них. Переход между страницами при этом осуществляется при помощи стандартных навигационных кнопок Мастера.

Для завершения разработки Мастера, остается добавить обработчики основных событий:

* *OnWizardFinished*(System.EventArgs_e_) – событие инициируется при нажатии на кнопку Finish, и позволяет реализовать необходимые действия по завершению его работы (сохранить результаты работы, выполнить какие-то действия, и т.д.)
* *OnWizardCanceled*(System.EventArgs_e_) событие инициируется при нажатии на кнопку Cancel, и позволяет реализовать необходимые действия по аварийному прерыванию его работы(закрыть форму на которой расположен Мастер)
* *OnSelectedIndexChanging*(DocsVision.Platform.WinForms.Controls.WizardControl.SelectedIndexChangingEventArgs e) – событие инициируется ДО смены вкладки (при перемещении вперед или назад), и позволяет в случае необходимости воспрепятствовать этому переходу (это может быть полезно для реализации проверки ввода всех необходимых параметров, прежде чем разрешить переход к следующему шагу)
* *OnSelectedIndexChanged*(System.EventArgs e) – это событие возникает ПОСЛЕ перехода на новый шаг (вперед или назад), и позволяет выполнить какие-то действия по инициализации элементов управления на новом шаге.

== См. также

* xref:CardsDevCompLibary.adoc[Разработка компонента библиотеки карточек]
