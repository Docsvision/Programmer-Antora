= Разработка схемы данных карточки

Архитектура {dv} предусматривает строго определённый способ взаимодействия ядра системы с пользовательскими карточками. Чтобы карточку можно было использовать в системе, структуры данных карточки и её программные компоненты должны соответствовать определённым стандартам.

Хранилище для данных карточки создается в базе данных {dv} автоматически. При этом в качестве исходных данных используется XML-файл с описанием структуры данных -- схема карточки, который должен быть подготовлен заранее. Файл содержит сведения о количестве данных в карточке, их типах и связях между ними. Фактически этот файл используется и при разработке программных компонент карточки, так как многие функции системы используют в качестве параметров вызова идентификаторы (GUID), которые закреплены за определёнными секциями данных в файле описания структуры.

Схема данных карточки описывает разделы (секции), которые в свою очередь состоят из строк. Под секциями понимаются группы данных, объединенных по общим признакам (полям или атрибутам). Строки секций могут ссылаться на другие секции (подчинённые секции). Для удобства организации данных выделяются три вида секций:

* _Плоская секция_ -- набор единичных значений атрибутов (полей);
* _Коллекционная секция_ -- таблица значений, которая может содержать несколько строк с однотипными полями;
* _Иерархическая секция_ -- таблица, строки которой ссылаются друг на друга, образуя древовидную (иерархическую) структуру. Поскольку каждая строка-узел может ссылаться на несколько дочерних строк, иерархическую секцию можно представить себе как иерархию секций одного типа.

image::dev_card_2.png[Виды секций]

Каждая секция имеет собственный уникальный идентификатор.

Схема также может определять виртуальные поля, которые используются при построении представлений (отчётов). Каждое виртуальное поле описывает логическую единицу данных карточки, значимую для пользователя (например, "Исполнители" или "Статус связанного процесса").

Кроме этого, схема карточки описывает возможные действия карточки с указанием их уникальных идентификаторов, режимы работы карточки -- возможные варианты отображения её пользовательского интерфейса, преобразования данных карточки -- варианты трансформации данных в другой формат при помощи XSLT и InfoPath-преобразований.

Разработка схемы карточки состоит из четырех основных этапов:

* подготовка базы данных;
* подготовка библиотеки карточек;
* создание и редактирование схемы данных;
* загрузка готовой схемы в базу данных.

Для выполнения всех этих операций используется программа "CardManager" (включена в Resource Kit).
