= Изменение состояния карточки

Пример кода, переводящего карточку группового задания в завершенное состояние:

[source,csharp]
----
// Получаем контекст
ObjectContext context = this.LocalContext;
            
// Получаем карточку
BaseCard taskGroupCard = GetParentCard();

if (taskGroupCard != null)
{
    // Блокируем карточку
    if (this.LocalContext.LockObject(taskGroupCard, false))
    {
        // Получаем сервис состояний
        ObjectModel.Services.IStateService stateService = context.GetService<ObjectModel.Services.IStateService>();

        // Получаем ветку перехода по встроенной ветке перехода
        StatesStateMachineBranch branch = stateService.FindBranchByBuiltIn(TaskGroup.PerformanceToCompletedByCompleteBranch, taskGroupCard.SystemInfo.State);
        if (branch = null)
            return false;

        // Получаем конечное состояние веки и присваиваем его полю состояния в карточке
        taskGroupCard.SystemInfo.State = branch.EndState;

        // Сохраняем карточку группового задания
        this.LocalContext.SaveObject<BaseCard>(taskGroupCard);

        // Разблокируем карточку
        this.LocalContext.UnlockObject(taskGroupCard);
    }
}
----
