= Получение ФИО пользователя

В приведенном далее примере _сценарий_ _бизнес-процесса_ формирует строку, содержащую ФИО сотрудника, из объекта `Сотрудник DV`.

_Сценарий_ работает со следующими _переменными процесса_:

* `UserDV` - сотрудник, для которого будет получена ФИО. Тип "Сотрудник DV".
* `User` - переменная будет использована для сохранения строки с ФИО. Тип "Строка".

[source,csharp]
----
// подключение системных библиотек
using System;
using System.Xml;

// подключение библиотек СУБП
using DocsVision.Workflow.Objects;
using DocsVision.Workflow.Runtime;
using DocsVision.Workflow.Gates;
using DocsVision.Platform.HelperAPI;

namespace DVScriptHost
{
 class DVScript
 {
  // Получение ФИО пользователя DV
  public void Execute(DocsVision.Workflow.Runtime.ProcessInfo process, PassState passInfo)
  {
   try
   {

    // Получение переменных процесса
    ProcessVariable oEmployeeID = process.GetVariableByName("UserDV");                
    ProcessVariable oUserFIO = process.GetVariableByName("User");
                
    // Приведение к типу Сотрудник DV
    DVPrincipal oEmployee = oEmployeeID.Value as DVPrincipal;

    // Получение строки вида Фамилия И.О.
    string sTempFIO = "";
    if (oEmployee.LastName.Length > 0) 
    { 
     sTempFIO = oEmployee.LastName; 
    }
    if (oEmployee.FirstName.Length > 0) 
    { 
     sTempFIO += " " + oEmployee.FirstName.Substring(0, 1) + "."; 
    }
    if (oEmployee.MiddleName.Length > 0) 
    { 
     sTempFIO += oEmployee.MiddleName.Substring(0, 1) + "."; 
    }
   
    // Сохранение найденного значения в переменную
    oUserFIO.Value = sTempFIO;
   } catch (Exception ex)
   {

    // Добавление сообщения об ошибке в журнал процесса
    process.LogMessage("Ошибка выполнения скрипта:" + ex.Message);
   }
  }
 }
}
----
