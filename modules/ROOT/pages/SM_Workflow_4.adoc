= Перемещение ярлыка карточки

Приведенный далее скрипт осуществляет перемещение сильной ссылки на карточку в заданную папку.

_Сценарий_ работает со следующими _переменными процесса_:

* `TargetFolder` -- папка {dv}, в которую будет перемещена ссылка. Тип "Папка DV".
* `Card` -- карточка, на которую указывает сильная ссылка. Тип "Карточка DV".

[source,csharp]
----
// подключение системных библиотек
using System;
using System.Xml;

// подключение библиотек СУБП
using DocsVision.Workflow.Objects;
using DocsVision.Workflow.Runtime;
using DocsVision.Workflow.Gates;
using DocsVision.Platform.HelperAPI;
using DocsVision.Platform.ObjectManager.SystemCards;
using DocsVision.Platform.ObjectManager;

namespace DVScriptHost
{
 class DVScript
 {
  public void Execute(DocsVision.Workflow.Runtime.ProcessInfo process, PassState passInfo)
  {
   try
   {
   
    // Получение переменных процесса
    ProcessVariable oTargetFolder = process.GetVariableByName("TargetFolder");
    ProcessVariable oCard = process.GetVariableByName("Card");

    // Приведение переменной к типу "Папка DV"
    DVFolder dvTargetFolder = oTargetFolder.Value as DVFolder;

    // Приведение переменной к типу "Карточка DV"
    DVCard dvCard = oCard.Value as DVCard;

    DVGate dvGate = process.Gates[DVGate.GateID] as DVGate;

    // Получение карточки папок
    FolderCard folder = dvGate.UserSession.CardManager.GetCard(new Guid("DA86FABF-4DD7-4A86-B6FF-C58C24D12DE2")) as FolderCard;
    
    // Получение сильной ссылки
    Shortcut shortcut = folder.FindHardLink(new Guid(dvCard.ID));
     
    if(shortcut != null)
    {

     // Перемещение ярлыка
     shortcut.Move(new Guid(dvTargetFolder.ID));
    }
   } catch (Exception ex)
   {
  
    // Добавление сообщения об ошибке в журнал процесса
    process.LogMessage("Ошибка выполнения скрипта:" + ex.Message);
   }
  }
 }
}
----
