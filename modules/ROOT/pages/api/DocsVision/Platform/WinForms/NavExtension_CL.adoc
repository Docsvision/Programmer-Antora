= NavExtension -- класс

Базовый класс для расширения Windows-клиента.

* *Пространство имен:* xref:api/DocsVision/Platform/WinForms/WinForms_NS.adoc[DocsVision.Platform.WinForms]
* *Сборка:* `DocsVision.Platform.WinForms.dll`

== Синтаксис

[source,csharp]
----
[ClassInterface(ClassInterfaceType.None)]
[ComVisible(true)]
[DefaultEvent("CardLoaded")]
[Guid("83458583-6D7E-41EE-B4D6-A3FD5D661CC9")]
[ToolboxItem(false)]
public class NavExtension : CardControl, INavExtension, INavCardSubTypesExtension, INavDragDropExtension, INavFolderExtTypesExtension, INavReportExtension, INavCommandExtension, INavStandardCommandExtension, INavEventExtension, INavPickerExtension, INavControlExtension, INavPropPagesExtension, INavCardCreatorExtension, INavCardCreatorEntryContainerExtension
----

== Конструкторы

[cols=",",options="header"]
|===
|Имя |Описание
|xref:api/DocsVision/Platform/WinForms/NavExtension_CT.adoc[NavExtension()] |Инициализирует новый экземпляр класса NavExtension.
|===

== Свойства

[cols=",",options="header"]
|===
|Имя |Описание
|Commands |Возвращает коллекцию команд расширения.
|PropertyPages |Возвращает коллекцию страниц свойств карточек и папок.
|StandardCommands |Возвращает коллекцию стандартных команд поддерживаемых расширением.
|SupportedTypes |Возвращает типы расширений реализуемые карточкой расширения.
|===

== Методы

[cols=",",options="header"]
|===
|Имя |Описание
|xref:api/DocsVision/Platform/WinForms/NavExtension.CreateCommands_MT.adoc[CreateCommands] |Возвращает информацию о командах расширения Windows-клиента.
|xref:api/DocsVision/Platform/WinForms/NavExtension.CreatePropertyPages_MT.adoc[CreatePropertyPages] |Создает и возвращает коллекцию страниц свойств.
|xref:api/DocsVision/Platform/WinForms/NavExtension.CreateReport_MT.adoc[CreateReport(Object, InfoRowCollection, Guid)] |Запускает механизм экспорта.
|GetExtensionName(NavExtensionTypes) |Возвращает название заданного расширения.
|xref:api/DocsVision/Platform/WinForms/NavExtension.InvokeCommand_MT.adoc[InvokeCommand(NavCommand, NavCommandContext)] |Вызов указанной команды расширения.
|InvokeStandardCommand(NavStandardCommand, NavCommandContext, Object) |Вызов стандартной команды.
|xref:api/DocsVision/Platform/WinForms/NavExtension.LookupAccounts_MT.adoc[LookupAccounts(String[], SecurityIdentifier[], String[], NavPickerAccountTypes[])] |Формирует коллекцию идентификаторов безопасности SID из коллекции имен учетных записей.
|xref:api/DocsVision/Platform/WinForms/NavExtension.LookupCardTypes_MT.adoc[LookupCardTypes(Guid[], Guid[])] |Сопоставляет заданной коллекции карточек их подтипы.
|xref:api/DocsVision/Platform/WinForms/NavExtension.LookupNames_MT.adoc[LookupNames(NavPickerNameFormat, NavPickerNameFormat, String[], String[])] |Формирует по заданным учетным данным коллекцию учетных данных заданного формата.
|xref:api/DocsVision/Platform/WinForms/NavExtension.LookupSids_MT.adoc[LookupSids(SecurityIdentifier[], String[], String[], NavPickerAccountTypes[])] |Формирует коллекцию учетных записей из заданной коллекции идентификаторов безопасности SID.
|OnDragEnter(DragEventArgs) |Создает событие при перетаскивания объекта, когда курсор входит в пределы контейнера карточки.
|OnDragLeave(DragEventArgs) |Создает событие, когда указатель выходит за границы контейнера карточки, в режиме перетаскивания.
|OnDrop(DragEventArgs, Folder) |Создает событие завершения перетаскивания, при отпускании объекта в пределах контейнера карточки.
|xref:api/DocsVision/Platform/WinForms/NavExtension.OnShutdown_MT.adoc[OnShutdown] |Вызывается при завершении работы Windows-клиента.
|xref:api/DocsVision/Platform/WinForms/NavExtension.OnStartup_MT.adoc[OnStartup] |Вызывается при загрузке Windows-клиента.
|xref:api/DocsVision/Platform/WinForms/NavExtension.PickAccounts_MT.adoc[PickAccounts(NavPickerAccountTypes)] |Отображает интерфейс выбора учетных записей.
|xref:api/DocsVision/Platform/WinForms/NavExtension.PopulateCardTypes_MT.adoc[PopulateCardTypes(INavCardTypeCollection)] |Формирует коллекцию всех доступных подтипов карточек.
|xref:api/DocsVision/Platform/WinForms/NavExtension.PopulateFolderTypes_MT.adoc[PopulateFolderTypes(INavFolderTypeCollection)] |Формирует коллекцию описаний типов папок.
|xref:api/DocsVision/Platform/WinForms/NavExtension.QueryCommandStatus_MT.adoc[QueryCommandStatus(NavCommand, NavCommandContext)] |Возвращает статус заданной команды.
|QueryCommandStatusEx(NavCommand[], NavCommandContext) |Возвращает статусы заданной коллекции команд.
|xref:api/DocsVision/Platform/WinForms/NavExtension.QueryFolderControl_MT.adoc[QueryFolderControl(NavFolderControlType, Guid)] |Возвращает для заданной папки режим работы с Windows-клиентом.
|QueryStandardCommandStatus(NavStandardCommand, NavCommandContext, Object) |Возвращает статус заданной стандартной команды.
|QueryStandardCommandStatusEx(NavStandardCommand[], NavCommandContext, Object) |Возвращает статусы заданной коллекции стандартных команд.
|Reset |Перезагружает расширение.
|===

== Примеры

[source,csharp]
----
[ComVisible(true)]
[Guid("6A0676EE-1DAF-4A59-B5EB-E0B5B4C175EE")]
[ClassInterface(ClassInterfaceType.None)]
public sealed partial class TestExtension : NavExtension
{
    public TestExtension() { }

    protected override NavExtensionTypes SupportedTypes
    {
        get
        {
            return NavExtensionTypes.All;
        }
    }
    protected override string GetExtensionName(NavExtensionTypes extensionType)
    {
        return "TextExtension";
    }
    //...
}
----


* *xref:api/DocsVision/Platform/WinForms/NavExtension.LookupCardTypes_MT.adoc[NavExtension.LookupCardTypes -- метод (Guid[], Guid[])]* +
* *xref:api/DocsVision/Platform/WinForms/NavExtension.LookupNames_MT.adoc[NavExtension.LookupNames -- метод (NavPickerNameFormat, NavPickerNameFormat, String[], String[])]* +
* *xref:api/DocsVision/Platform/WinForms/NavExtension.LookupSids_MT.adoc[NavExtension.LookupSids -- метод (SecurityIdentifier[], String[], String[], NavPickerAccountTypes[])]* +
* *xref:api/DocsVision/Platform/WinForms/NavExtension.OnStartup_MT.adoc[NavExtension.OnStartup -- метод]* +



